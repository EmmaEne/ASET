<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Admin | ASET</title>
    <link href="styles.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body class="bg-light">

    <div class="dashboard-layout">
        <aside class="sidebar" style="background: #1e293b;"> <!-- Darker sidebar for Super Admin -->
            <div class="sidebar-header">
                <a href="#" class="d-flex align-items-center gap-2 text-white text-decoration-none fs-4 fw-bold">
                    <span class="bg-danger text-white rounded px-2"><i class="bi bi-cpu-fill"></i></span>
                    <span style="font-family: var(--font-display);">ROOT</span>
                </a>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-link-custom active"><i class="bi bi-activity"></i> Audit Logs</a>
                <a href="#" class="nav-link-custom"><i class="bi bi-shield-lock-fill"></i> Access Control</a>
                <a href="#" class="nav-link-custom"><i class="bi bi-server"></i> Database</a>
            </nav>

            <div class="p-3 border-top border-white border-opacity-10">
                <button class="btn btn-link text-white w-100 text-start ps-0" onclick="ASET.logout()">
                    <i class="bi bi-box-arrow-right me-2"></i> Logout
                </button>
            </div>
        </aside>

        <main class="main-content">
            <header class="d-flex justify-content-between align-items-center mb-5">
                <div>
                    <h2 class="fw-bold mb-1">System Audit Trail</h2>
                    <p class="text-secondary">Monitor all system activities and user actions in real-time.</p>
                </div>
                <button class="btn btn-outline-danger btn-sm fw-bold">
                    <i class="bi bi-lock-fill me-1"></i> Security Level: High
                </button>
            </header>

            <div class="card-clean p-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="fw-bold"><i class="bi bi-list-columns-reverse me-2 text-primary"></i>Activity Log</h5>
                    <button class="btn btn-sm btn-light border" onclick="exportLogs()"><i
                            class="bi bi-download me-2"></i>Export CSV</button>
                </div>

                <div class="table-responsive">
                    <table class="table align-middle table-hover">
                        <thead class="bg-light text-secondary small text-uppercase">
                            <tr>
                                <th class="ps-3 border-0 py-3">Timestamp</th>
                                <th class="border-0 py-3">User</th>
                                <th class="border-0 py-3">Role</th>
                                <th class="border-0 py-3">Action Type</th>
                                <th class="border-0 py-3">Details</th>
                            </tr>
                        </thead>
                        <tbody id="logsTable" class="border-top-0">
                            <!-- JS Populated -->
                        </tbody>
                    </table>
                </div>
            </div>

        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
    <script>
        ASET.checkAuth('superadmin');

        const logs = ASET.getLogs();
        const tbody = document.getElementById('logsTable');

        if (logs.length === 0) { // Should rarely happen as initial seed creates logs or user login creates logs
            tbody.innerHTML = '<tr><td colspan="5" class="text-center py-5 text-muted">No activities recorded yet.</td></tr>';
        } else {
            logs.forEach(log => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="ps-3 text-secondary font-monospace small">${ASET.formatDate(log.timestamp)}</td>
                    <td class="fw-bold text-dark">${log.user}</td>
                    <td><span class="badge bg-secondary-subtle text-secondary border">${log.role.toUpperCase()}</span></td>
                    <td><span class="badge-pill bg-status-info">${log.type}</span></td>
                    <td class="text-secondary small">${log.action}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function exportLogs() {
            alert('Exporting system logs to secured CSV format...');
        }
    </script>
</body>

</html>